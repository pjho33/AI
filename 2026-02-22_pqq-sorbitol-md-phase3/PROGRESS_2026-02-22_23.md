# PQQ-Sorbitol MD Phase 3 진행 기록 (2026-02-22 ~ 23)

## 목표
Gluconobacter oxydans sldA (PQQ-dependent alcohol dehydrogenase) 단백질에 대해
- L-sorbitol (LSO), D-sorbitol (DSO)의 결합 포즈 도킹
- 3개 시스템 (PQQ only / PQQ+LSO / PQQ+DSO) 10ns MD 시뮬레이션
- 리간드 결합 안정성 비교 분석

---

## 완료된 작업

### Phase 1: 파라미터화 (2026-02-21, 이전 세션)
- PQQ GAFF2 파라미터화 완료 (net charge -3, acpype)
- LSO, DSO GAFF2 파라미터화 완료 (net charge 0)
- `ligand_atomtypes.itp`: PQQ + LSO/DSO 통합 atomtypes (중복 제거)
- `PQQ_GMX_no_atomtypes.itp`, `LSO_GMX_no_atomtypes.itp`, `DSO_GMX_no_atomtypes.itp` 생성

### Phase 2: 도킹 (2026-02-22)
- AutoDock Vina 도킹 완료
  - LSO: **-5.21 kcal/mol** (best pose)
  - DSO: **-5.15 kcal/mol** (best pose)
- receptor.pdbqt: System 1 MD 최종 구조 기반

### Phase 3: System 2 (PQQ+LSO) 빌드 (2026-02-22)

#### 핵심 문제 해결: 좌표계 변환
- Vina 도킹 결과는 receptor.pdbqt 좌표계 (Å)
- GROMACS protein.gro는 원점 중심 좌표계 (nm)
- **해결**: receptor.pdbqt CA 원자 center vs protein.gro CA 원자 center 차이로 shift 계산
  ```python
  shift = gro_ca.mean(axis=0) - pdbqt_ca.mean(axis=0)
  # shift = [-9.452, -10.268, -5.321] nm
  ```
- LSO_docked_pose1.gro에 shift 적용 → LSO_repositioned.gro

#### 빌드 파이프라인
```
protein.pdb (ATOM only) → pdb2gmx → protein.gro
protein.gro + PQQ_GMX.gro + LSO_repositioned.gro → complex.gro (10576 atoms)
editconf → complex_box.gro (12.2 nm cubic box)
topol.top: forcefield + ligand_atomtypes + PQQ itp + LSO itp
solvate → 56144 SOL
genion -neutral → 19 NA (charge -19 from PQQ)
EM: 1139 steps, Fmax=994 ✓
NVT: 100ps, 300K ✓
NPT: 100ps, 1bar ✓
Production MD: 10ns ✓
```

#### tc-grps 처리
- index.ndx 미생성으로 `Protein / non-Protein` 사용 (차선책)
- **다음 시스템부터는 index.ndx + posre.itp 먼저 생성** (가이드라인에 반영)

### Phase 4: System 3 (PQQ+DSO) 빌드 (2026-02-22~23)

#### 가이드라인 준수 (개선된 파이프라인)
- DSO_GMX_no_atomtypes.itp 생성
- DSO_docked_pose1.gro 생성 (pdbqt heavy atoms → gro 원자 순서 매핑)
- 동일한 shift 적용 → DSO_repositioned.gro
- DSO-PQQ 거리: 1.46 nm (합리적)

```
complex.gro (10576 atoms)
editconf → 12.2 nm cubic box
solvate → 56145 SOL
genion -neutral -conc 0.15 → 183 NA + 164 CL
make_ndx: Protein_PQQ_DSO (그룹 22), SOL_ions (그룹 23) ✓
genrestr → posre.itp ✓
EM: 1432 steps, Fmax=791 ✓
NVT: 100ps ✓ (index.ndx 포함)
NPT: 100ps ✓ (index.ndx 포함)
Production MD: 10ns ✓
```

---

## 분석 결과

### Backbone RMSD (10ns)
| System | Mean ± Std (Å) |
|--------|---------------|
| Sys1 (PQQ only) | 4.29 ± 0.87 |
| Sys2 (PQQ+LSO)  | 6.03 ± 1.91 |
| Sys3 (PQQ+DSO)  | 5.06 ± 1.12 |

### Ligand RMSD (self-fit, 10ns)
| Ligand | Mean ± Std (Å) | 해석 |
|--------|---------------|------|
| PQQ (Sys1) | 1.78 ± 0.17 | 내부 유연성 있음 |
| LSO (Sys2) | 1.09 ± 0.46 | ~4ns에 conformation 전환 |
| **DSO (Sys3)** | **0.32 ± 0.10** | **가장 안정적** |

### Cα RMSF 평균
| System | Mean RMSF (Å) |
|--------|--------------|
| Sys1 | 1.47 |
| Sys2 | 2.05 |
| Sys3 | 1.66 |

### 주요 해석
- **DSO가 결합 포켓에서 가장 안정** (RMSD 0.32Å, RMSF 낮음)
- **LSO는 ~4ns에 conformation 전환** 발생 → 결합 포켓 내 재배열
- **LSO 시스템에서 단백질 유연성 증가** (backbone RMSD 6.03Å, RMSF 2.05Å)
- 도킹 친화도는 LSO(-5.21) > DSO(-5.15)이지만, MD에서는 DSO가 더 안정

---

## 파일 구조
```
2026-02-22_pqq-sorbitol-md-phase3/
├── mdp/                    # em, nvt, npt, md, ions MDP 파일
├── docking/                # receptor.pdbqt, LSO/DSO 도킹 결과
├── gromacs/                # System 1 (PQQ only) - 완료
├── gromacs_lso/            # System 2 (PQQ+LSO) - 완료
├── gromacs_dso/            # System 3 (PQQ+DSO) - 완료
└── analysis_3systems.png   # 3개 시스템 비교 플롯
```

---

## 다음 단계 (저녁)
- [ ] MM-PBSA 결합 에너지 분석 (gmx_MMPBSA v1.5.0.3 설치됨)
  - LSO vs DSO 결합 자유 에너지 (ΔG) 계산
  - 도킹 친화도와 비교
- [ ] 수소결합 분석 (gmx hbond)
- [ ] 결합 포켓 접촉 잔기 분석

---

## 핵심 워크플로우 (다음 시스템 재사용)
1. `grep "^ATOM" receptor.pdb > protein.pdb`
2. `pdb2gmx -f protein.pdb` (단백질만)
3. receptor.pdbqt CA ↔ protein.gro CA shift 계산
4. 리간드 도킹 좌표에 shift 적용
5. `protein.gro + PQQ_GMX.gro + ligand_repositioned.gro → complex.gro`
6. `topol.top`: ligand_atomtypes + PQQ itp + ligand itp
7. editconf → solvate → genion (-neutral -conc 0.15)
8. **make_ndx** (Protein+PQQ+ligand 그룹) + **genrestr** (posre.itp) ← 반드시 EM 전에
9. EM → NVT → NPT → MD (모두 `-n index.ndx` 포함)
